<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stakeholder Map - Human in the Loop Coalition</title>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --owa-orange: #CD4C1D;
            --owa-black: #1a1a1a;
            --owa-bg-light: #f9f7f2;
            --owa-text: #333333;
            --internal-blue: #2d6671;
            --text-inv: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Sora', sans-serif;
            line-height: 1.6;
            color: var(--owa-text);
            background-color: #fff;
            overflow-x: hidden;
        }

        /* --- NAVIGATION --- */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 10%;
            background: white;
        }

        .logo {
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--owa-orange);
            text-transform: lowercase;
            text-decoration: none;
        }

        nav ul { display: flex; list-style: none; align-items: center; }
        nav ul li { margin-left: 2rem; }
        nav ul li a { 
            text-decoration: none; 
            color: var(--owa-orange); 
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* --- BANNIÈRE ORANGE --- */
        .page-banner {
            background-color: var(--owa-orange);
            color: white;
            padding: 4rem 10%;
        }

        .page-banner h1 {
            font-size: 3.5rem;
            font-weight: 800;
            text-transform: lowercase;
        }

        /* --- SECTION CONTEXTE CORRIGÉE --- */
        .map-intro {
            padding: 4rem 10%;
            display: grid;
            grid-template-columns: 300px 1fr; /* Colonne fixe pour le titre, le reste pour le texte */
            gap: 4rem;
            background-color: white;
            align-items: start;
        }

        .map-intro h2 {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--owa-orange);
            text-transform: lowercase;
            line-height: 1.1;
        }

        .map-intro div {
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Espace constant entre les paragraphes */
        }

        .map-intro p {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--owa-text);
            margin: 0; /* On utilise le gap du parent pour l'espacement */
        }

        @media (max-width: 900px) {
            .map-intro {
                grid-template-columns: 1fr; /* Repasse en colonne sur mobile */
                gap: 1.5rem;
            }
        }

        /* Style spécifique pour le paragraphe final en gras */
        .map-intro p strong {
            color: var(--owa-black);
        }

        /* --- STAKEHOLDER MAP SECTION --- */
        .map-section {
            background-color: var(--owa-bg-light);
            padding: 4rem 5%;
            text-align: center;
        }

        #map-container {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 80vh;
            min-height: 600px;
            margin: 0 auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .stakeholder {
            position: absolute;
            padding: 0.7rem 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 700;
            z-index: 10;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
            white-space: nowrap;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 2px solid transparent;
        }

        .stakeholder:hover {
            transform: translate(-50%, -55%);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        /* Couleurs des groupes basées sur votre fichier original */
        .group-internal { background: linear-gradient(135deg, #79B2BD 10%, #2d6671 90%); color: white; }
        .group-central { background: linear-gradient(135deg, #e74c3c 0%, #9A3615 100%); color: white; }
        .group-external { background: linear-gradient(135deg, #CD4C1D 0%, #bb461b 100%); color: white; }
        .group-governance { background: linear-gradient(135deg, #628F94 0%, #2e7880 100%); color: white; }
        .group-hybrid { background: linear-gradient(135deg, #2e7880 50%, #79B2BD 50%); color: white; border-radius: 8px; }

        /* --- MODAL --- */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center; justify-content: center;
        }

        .modal.active { display: flex; }

        .modal-content {
            background: white;
            padding: 3rem;
            max-width: 650px;
            width: 90%;
            border-radius: 12px;
            position: relative;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-header {
            border-bottom: 3px solid var(--owa-orange);
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
        }

        .modal-header h2 {
            color: var(--owa-orange);
            font-size: 1.8rem;
            text-transform: lowercase;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--owa-black);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body h3 { color: var(--owa-orange); margin: 1.5rem 0 0.5rem; }
        .modal-body p { margin-bottom: 1rem; line-height: 1.8; }

        @media (max-width: 768px) {
            .map-intro { grid-template-columns: 1fr; gap: 1rem; }
            .stakeholder { font-size: 0.7rem; padding: 0.5rem 0.8rem; }
            .page-banner h1 { font-size: 2.2rem; }
        }

                /* Alignement Logo Header */
        .logo-wrapper {
            display: flex;
            align-items: center;
            text-decoration: none;
            gap: 15px; /* Espace entre logo et texte */
        }

        .header-logo {
            height: 150px; /* Ajustez selon votre logo */
            width: auto;
        }

        .logo-text {
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--owa-orange);
            text-transform: lowercase;
        }

        /* Style du bouton Join Us */
        .join-btn {
            border: 2px solid var(--owa-orange);
            padding: 8px 20px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .join-btn:hover {
            background-color: var(--owa-orange);
            color: white !important;
        }

        /* --- FOOTER STYLES --- */
        .site-footer {
            background-color: var(--owa-orange);
            color: white;
            padding: 4rem 10%;
            margin-top: 4rem;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4rem;
        }

        .footer-column h3 {
            text-transform: lowercase;
            font-weight: 800;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            display: inline-block;
        }

        .footer-column p, .footer-column a {
            font-size: 0.9rem;
            color: white;
            text-decoration: none;
            line-height: 1.6;
        }

        .footer-column a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .footer-grid { grid-template-columns: 1fr; gap: 2rem; }
            .map-intro { padding: 3rem 5%; }
        }
    </style>
</head>
<body>

    <nav>
        <a href="index.html" class="logo-wrapper">
            <img src="logo.png" alt="HCL Logo" class="header-logo">
            <span class="logo-text">human in the loop coalition</span>
        </a>
        <ul>
            <li><a href="index.html#vision">Our Vision</a></li>
            <li><a href="page.html?p=context">Context</a></li>
            <li><a href="stakeholder_map.html">Stakeholder Map</a></li> 
            <li><a href="page.html?p=action">Call for Action</a></li>
            <li><a href="page.html?p=join" class="join-btn">Join Us</a></li>
        </ul>
    </nav>

    <header class="page-banner">
        <h1>stakeholder map.</h1>
    </header>

    <section class="map-intro">
        <h2>Mapping the tensions</h2>
        <div>
            <p>This interactive map reveals the full web of power around the AI citizenship tool. It depicts who gains, who loses, and where we can strike alliances or expose contradictions.</p>
            <p>As the trade union, we use the map to demystify the <strong>efficiency narrative:</strong> management hides behind tech promises, but caseworkers bear the risks, citizens face biases, and politicians chase headlines. Click to see our analysis of each players’s position, interests, and tensions: arming you with the intel to join our fight. 
            <p><strong>This interactive map presents the key players involved in AI deployment within the Ministry. Click on each bubble to discover their official position, interests, and the friction points identified by our union. </strong>.</p>
        </div>
    </section>

    <section class="map-section">
        <div id="map-container">
            <svg id="connections"></svg>
        </div>
    </section>

    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">×</button>
            <div class="modal-header">
                <h2 id="modal-title"></h2>
            </div>
            <div id="modal-body" class="modal-body"></div>
        </div>
    </div>

    <script>
        const stakeholders = [
            { id: 'civil-servants', name: 'Civil Servants (Caseworkers)', group: 'internal', x: 15, y: 25 },
            { id: 'it-department', name: 'Internal IT Department', group: 'internal', x: 8, y: 45 },
            { id: 'ethics-board', name: 'Ethics Board', group: 'internal', x: 15, y: 60 },
            { id: 'legal-department', name: 'Legal Department', group: 'internal', x: 35, y: 15 },
            { id: 'data-protection', name: 'Data Protection Authority', group: 'governance', x: 20, y: 75 },
            { id: 'external-ai', name: 'External AI Contractor', group: 'governance', x: 45, y: 38 },
            { id: 'trade-union', name: 'Trade Union (Our Vision)', group: 'central', x: 45, y: 52 },
            { id: 'political-leadership', name: 'Political Leadership', group: 'hybrid', x: 70, y: 15 },
            { id: 'media', name: 'Media', group: 'external', x: 80, y: 35 },
            { id: 'researchers', name: 'Researchers', group: 'external', x: 75, y: 50 },
            { id: 'civil-society', name: 'Citizens, Civil Society', group: 'external', x: 75, y: 65 },
            { id: 'lydoria-rights', name: 'Lydoria Rights Collective', group: 'external', x: 65, y: 78 },
            { id: 'migrant-solidarity', name: 'Migrant Solidarity Network', group: 'external', x: 85, y: 82 }
        ];

        const connections = [
            ['civil-servants', 'it-department'], ['civil-servants', 'legal-department'],
            ['civil-servants', 'external-ai'], ['civil-servants', 'trade-union'],
            ['it-department', 'ethics-board'], ['it-department', 'trade-union'],
            ['ethics-board', 'data-protection'], ['ethics-board', 'external-ai'],
            ['data-protection', 'trade-union'], ['data-protection', 'external-ai'],
            ['legal-department', 'external-ai'], ['legal-department', 'political-leadership'],
            ['external-ai', 'trade-union'], ['external-ai', 'media'],
            ['external-ai', 'political-leadership'], ['trade-union', 'media'],
            ['trade-union', 'researchers'], ['trade-union', 'civil-society'],
            ['trade-union', 'political-leadership'], ['political-leadership', 'media'],
            ['media', 'researchers'], ['researchers', 'civil-society'],
            ['civil-society', 'lydoria-rights'], ['civil-society', 'migrant-solidarity'],
            ['lydoria-rights', 'migrant-solidarity']
        ];

        const container = document.getElementById('map-container');
        const positions = {};

        // Création des bulles
        stakeholders.forEach(sh => {
            const div = document.createElement('div');
            div.className = `stakeholder group-${sh.group}`;
            div.textContent = sh.name;
            div.style.left = `${sh.x}%`;
            div.style.top = `${sh.y}%`;
            div.onclick = () => openModal(sh.id, sh.name);
            container.appendChild(div);
            positions[sh.id] = { x: sh.x, y: sh.y };
        });

        // Dessin des lignes
        function drawConnections() {
            const svg = document.getElementById('connections');
            const containerRect = container.getBoundingClientRect();
            svg.innerHTML = '';

            connections.forEach(([id1, id2]) => {
                const pos1 = positions[id1];
                const pos2 = positions[id2];
                if (!pos1 || !pos2) return;
                
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', (pos1.x / 100) * containerRect.width);
                line.setAttribute('y1', (pos1.y / 100) * containerRect.height);
                line.setAttribute('x2', (pos2.x / 100) * containerRect.width);
                line.setAttribute('y2', (pos2.y / 100) * containerRect.height);
                line.setAttribute('stroke', '#bdc3c7');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('stroke-opacity', '0.4');
                svg.appendChild(line);
            });
        }

        window.addEventListener('resize', drawConnections);
        drawConnections();

        // Fonctions Modal et Markdown
        async function openModal(id, name) {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modal-body');
            document.getElementById('modal-title').textContent = name;
            body.innerHTML = '<p>Chargement...</p>';
            modal.classList.add('active');
            
            const filename = `${id.replace(/-/g, '_')}_position.md`;
            try {
                const response = await fetch(filename);
                if (!response.ok) throw new Error();
                const text = await response.text();
                body.innerHTML = parseMarkdown(text);
            } catch {
                body.innerHTML = `<p><em>Document non disponible (${filename}).</em></p>`;
            }
        }

        function closeModal() { document.getElementById('modal').classList.remove('active'); }
        
        function parseMarkdown(text) {
            return text
                .replace(/### (.*?)$/gm, '<h3>$1</h3>').replace(/## (.*?)$/gm, '<h3>$1</h3>').replace(/# (.*?)$/gm, '<h3>$1</h3>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/\n\n/g, '</p><p>').replace(/^(.+)$/gm, '<p>$1</p>')
                .replace(/<p><h3>/g, '<h3>').replace(/<\/h3><\/p>/g, '</h3>').replace(/<p><\/p>/g, '');
        }

        document.getElementById('modal').onclick = (e) => { if (e.target.id === 'modal') closeModal(); };
    </script>

    <footer class="site-footer">
        <div class="footer-grid">
            <div class="footer-column">
                <h3>Team</h3>
                <p>Dariia HARYFULLINA, Frida HELLEN, Léo LE DOUAREC, Kai MÜTSCHELE, Léo REINBOLD</p>
            </div>
            <div class="footer-column">
                <h3>Links</h3>
                <a href="https://github.com/Lyreck/DPT_website#" target="_blank">View the website's source code on GitHub</a>
            </div>
            <div class="footer-column">
                <h3>Credits</h3>
                <p>This website was built using Gemini 3 and is based on Open Web Advocacy's public website: <a href="https://open-web-advocacy.org" target="_blank">Open Web Advocacy (OWA)</a>.</p>
            </div>
        </div>
    </footer>
</body>
</html>